---
# yaml-language-server: $schema=https://schema.blue-build.org/module-list-v1.json
modules:
  - type: files
    files:
      - source: common
      - destination: /
  - type: dnf
    repos:
      nonfree: rpmfusion
      files:
        - "https://download.docker.com/linux/fedora/docker-ce.repo"
    remove:
      packages:
        - power-profiles-daemon # we replace with tuned
        # We will use docker-ce
        - "moby-engine"
        - "docker-cli"
    install:
      packages:
        - "docker-ce"
        - "docker-ce-cli"
        - "containerd.io"
        - "docker-buildx-plugin"
        - "docker-compose-plugin"
        - "gcc"
        - "clang"
        - "mold"
        - "zsh"
        - "openssl"
        - "p7zip"
        - "unzip"
        - "smartmontools"
        - "tuned"
        - "tuned-ppd"
        - "tuned-utils"
        - "tuned-utils-systemtap"
        - "tuned-profiles-atomic"
        - "virt-install"
        - "libvirt-daemon-config-network"
        - "libvirt-daemon-kvm"
        - "qemu-kvm"
        - "guestfs-tools"
        - "python3-libguestfs"
        - "virt-top"
  - type: systemd
    system:
      enabled:
        - "rpm-ostreed-automatic.timer"
        - "docker.service"
        - "tuned.service"
        - "libvirtd.service"
